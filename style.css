/* style.css
   Updated: when the book is opened, the left and right panel visuals are hidden
   and the sketchbook uses rightpage.png as a full spread background.
   - The open-state background is rendered via .sketchbook.open::before.
   - Left/right panels are hidden visually when open to give a single background look.
   - JS will set the --open-bg-url CSS variable (see script.js) so the image path is consistent.
*/

/* Typekit Carrotflower is loaded in index.html. Fallback to Amatic SC if missing. */
:root{
  --paper: #fbf7ef;
  --edge: #d8cbb9;
  --ink: #1b1b1b;
  --spine: 12px;     /* visual gutter between halves */
  --page-padding: 28px;
  --gutter: 20px;    /* outer padding around the book area */
}

/* Reset & base */
* { box-sizing: border-box; }
html, body, #app { height:100%; margin:0; background:var(--paper); -webkit-font-smoothing:antialiased; }
body {
  font-family: "Carrotflower", "Amatic SC", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue";
  color: var(--ink);
  overflow-y: auto;
}

/* soft paper texture background (full viewport) */
.paper-bg {
  position: fixed;
  inset: 0;
  z-index: -1;
  background:
    linear-gradient(180deg, rgba(255,255,255,0.06) 0%, transparent 40%),
    url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60"><rect fill="%23fbf7ef" width="100%" height="100%"/></svg>');
}

/* SKETCHBOOK: full-bleed "stage" */
.sketchbook {
  width: 100%;
  min-height: calc(100vh - (var(--gutter) * 2));
  padding: var(--gutter);
  margin: 0;
  position: relative;
  transform-style: preserve-3d;
  overflow: visible;
  user-select: none;
  -webkit-user-select: none;
  /* fallback open background variable (set from JS) */
  --open-bg-url: url("assets/rightpage.png");
}

/* When opened, show a full-bleed background using the rightpage artwork.
   We render it via a pseudo-element so it's below the cover title/button but above the page background. */
.sketchbook.open::before {
  content: "";
  position: absolute;
  top: var(--gutter);
  left: var(--gutter);
  right: var(--gutter);
  bottom: var(--gutter);
  z-index: 6; /* below cover-art (z-index:20) and controls (z-index:500) */
  background: var(--open-bg-url) center/cover no-repeat;
  pointer-events: none;
  border-radius: 0;
}

/* LEFT PAGE: left half (kept in DOM but hidden visually when open) */
.left-page {
  position: absolute;
  top: var(--gutter);
  left: var(--gutter);
  bottom: var(--gutter);
  width: calc((100% - (var(--gutter) * 2)) / 2 - (var(--spine) / 2));
  padding: var(--page-padding);
  display: flex;
  flex-direction: column;
  gap: 12px;
  z-index: 20;
  background-image: url("assets/leftpage.png");
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
  border-left: 6px solid rgba(0,0,0,0.03);
}

/* RIGHT PAGES container (kept in DOM but hidden visually when open) */
.pages {
  position: absolute;
  top: var(--gutter);
  right: var(--gutter);
  bottom: var(--gutter);
  width: calc((100% - (var(--gutter) * 2)) / 2 - (var(--spine) / 2));
  transform-style: preserve-3d;
  z-index: 30;
}

/* Page & cover base */
.page, .cover {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 100%;
  padding: var(--page-padding);
  box-sizing: border-box;
  display: flex;
  align-items: flex-start;
  justify-content: flex-start;
  border: 2px solid var(--edge);
  border-right: 6px solid rgba(0,0,0,0.02);
  box-shadow: 0 24px 60px rgba(17,17,17,0.18);
  backface-visibility: hidden;
  transform-origin: left center;
  background-color: rgba(251,247,239,0.95);
}

/* Default right-page background */
.pages .page {
  background-image: url("assets/rightpage.png");
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
}

/* COVER specifics */
.cover {
  z-index: 200;
  right: var(--gutter);
  left: auto;
  width: calc((100% - (var(--gutter) * 2)) / 2 - (var(--spine) / 2));
  position: absolute;
  top: var(--gutter);
  bottom: var(--gutter);
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  transition: all 320ms ease;
}

/* cover image via pseudo-element (below overlay content) */
.cover::before {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 10;
  background: url("assets/bookcover.jpg") center/contain no-repeat;
  pointer-events: none;
  background-color: transparent;
}

/* CLOSED cover centered across the full stage */
.sketchbook:not(.open) .cover {
  left: 50%;
  transform: translateX(-50%) rotateY(0deg) !important;
  box-shadow: 0 30px 70px rgba(17,17,17,0.28);
  right: auto;
}

/* OPEN cover returns to the right half */
.sketchbook.open .cover {
  left: auto;
  right: var(--gutter);
  transform: none;
}

/* HIDE left/right visual panels when the book is open.
   Panels remain in the DOM (so flipping and accessibility remain functional),
   but their visuals (backgrounds, borders, shadows) are removed so the open
   background (rightpage.png) shows as a single full-spread image. */
.sketchbook.open .left-page,
.sketchbook.open .pages,
.sketchbook.open .pages .page {
  background-image: none !important;
  border: none !important;
  box-shadow: none !important;
  background-color: transparent !important;
}

/* cover overlay content */
.cover-art {
  text-align: center;
  z-index: 20;
  pointer-events: none;
  width: 100%;
  max-width: calc((100% - (var(--gutter) * 2)) / 2 - (var(--spine) / 2) - (var(--page-padding) * 2));
}
.cover-art .cover-title {
  margin: 0;
  font-size: 34px;
  line-height: 1;
  font-family: "Carrotflower", "Amatic SC", sans-serif;
}
.cover-art .subtitle { margin: 6px 0 12px 0; color: #7a6a5a; }

/* Enter button */
.enter-btn {
  pointer-events: auto;
  margin-top: 6px;
  padding: 10px 18px;
  background: rgba(255,255,255,0.95);
  border: 2px solid #cbb79f;
  border-radius: 8px;
  cursor: pointer;
  font-family: "Carrotflower", "Amatic SC", sans-serif;
  font-size: 18px;
  color: var(--ink);
  box-shadow: 0 6px 10px rgba(0,0,0,0.08);
}

/* page content */
.page-content {
  z-index: 80;
  width: 100%;
  color: var(--ink);
  background: transparent;
  font-size: 18px;
}
.page-content h2 {
  margin: 0 0 12px 0;
  font-size: 26px;
  font-weight: 700;
  font-family: "Carrotflower", "Amatic SC", sans-serif;
}

/* top-right menu visibility (unchanged) */
.sketchbook:not(.open) #pageMenu { display: none !important; pointer-events: none !important; opacity: 0 !important; }
.sketchbook.open #pageMenu { display: flex !important; pointer-events: auto !important; opacity: 1 !important; }

/* bottom arrow controls */
.controls {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: calc(var(--gutter) / 2);
  display: flex;
  gap: 12px;
  z-index: 500;
}
.controls button {
  background: var(--paper);
  border: 2px solid #cbb79f;
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 18px;
  cursor: pointer;
  font-family: "Carrotflower", "Amatic SC", sans-serif;
}

/* spine gutter (unchanged visual) */
.sketchbook::after {
  content: "";
  position: absolute;
  left: calc(50% - (var(--spine) / 2));
  top: var(--gutter);
  bottom: var(--gutter);
  width: var(--spine);
  pointer-events: none;
  background: linear-gradient(90deg, rgba(0,0,0,0.04), rgba(0,0,0,0.02) 40%, rgba(0,0,0,0.00));
  z-index: 40;
}

/* responsive: reduce paddings and scale down elements on small screens */
@media (max-width: 880px) {
  :root { --gutter: 12px; --page-padding: 18px; }
  .cover-art .cover-title { font-size: 22px; }
  .enter-btn { font-size: 16px; padding: 8px 12px; }
  .page-content h2 { font-size: 20px; }
}

/* very small screens: stack pages vertically for readability */
@media (max-width: 560px) {
  .left-page, .pages, .cover {
    position: relative;
    width: 100%;
    top: 0;
    left: 0;
    right: 0;
    height: auto;
  }
  .left-page { padding: 12px 12px 24px; }
  .left-page::before { display: none; } /* ensure no residual pseudo-element */
  .pages .page { background-size: cover; }
  .cover::before { background-size: cover; }
  .sketchbook { min-height: auto; padding: 12px; }
  .controls { position: static; transform: none; margin: 12px 0; justify-content: center; }
}
